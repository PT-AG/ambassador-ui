<template>
  <au-input-form title.bind="title" with.bind="context">
    <au-textbox label="No DO Penjualan Export" value.bind="data.exportSalesDONo" read-only="true"
      options.bind="controlOptions" if.bind="readOnly || data.id">
    </au-textbox>

    <au-datepicker label="Tgl DO" value.bind="data.date" error.bind="error.date" read-only.bind="readOnly"
      options.bind="controlOptions">
    </au-datepicker>

    <au-autocomplete value.bind="selectedBuyerAgent" error.bind="error.buyerAgent" label="Buyer Agent"
      loader.bind="buyerLoader" text.bind="buyerView" placeholder="Cari Buyer" read-only.bind="readOnly || data.id"
      options.bind="controlOptions">
    </au-autocomplete>

    <au-autocomplete label="Packing List No" placeholder="Pilih no packing list" value.bind="selectedPackingList"
      error.bind="error.packingList" loader.bind="packingListLoader" text.bind="packingListView" query.bind="filter"
      read-only.bind="readOnly || data.id" options.bind="controlOptions">
    </au-autocomplete>

    <!-- <au-textbox label="Buyer Agent" value.bind="data.buyerAgent.name || ''" error.bind="error.buyerAgent"
      read-only.bind="true" options.bind="controlOptions">
    </au-textbox> -->

    <au-textbox label="Kepada" value.bind="data.to" error.bind="error.to" read-only.bind="readOnly"
      options.bind="controlOptions">
    </au-textbox>

    <au-autocomplete label="Bag. Gudang Packing" placeholder="Pilih Bag. Gudang Packing" value.bind="data.unit"
      error.bind="error.unit" loader.bind="unitLoader" text.bind="unitView" query.bind="unitQuery"
      read-only.bind="readOnly || isEdit" options.bind="controlOptions">
    </au-autocomplete>

    <au-dropdown label="Shipment Mode" value.bind="data.shipmentMode" error.bind="error.shipmentMode"
      read-only.bind="readOnly" items.bind="ShipmentModeOptions" options.bind="controlOptions">
    </au-dropdown>

    <au-textbox label="Tujuan" value.bind="data.deliverTo" error.bind="error.deliverTo" read-only.bind="readOnly"
      options.bind="controlOptions">
    </au-textbox>

    <au-multiline label="Keterangan" value.bind="data.remark" error.bind="error.remark" read-only.bind="readOnly"
      options.bind="controlOptions">
    </au-multiline>

    <div class="form-group has-error">
      <p if.bind="error.itemsCount" class="help-block text-center">${error.itemsCount}</p>
    </div>

    <au-collection items.bind="data.items" errors.bind="error.items" columns.bind="itemsColumns"
      read-only.bind="readOnly" options.bind="Options"
      item-template="modules/garment-shipping/export-sales-do/template/item">
    </au-collection>

    <!-- <au-collection items.bind="data.items" errors.bind="error.items" columns.bind="itemsColumns"
      read-only.bind="readOnly" add.bind="addItems" remove.bind="removeItems" options.bind="Options"
      item-template="modules/garment-shipping/export-sales-do/template/item">
    </au-collection> -->

    <div class="row">
      <div class=" col-md-6">
        <h4>File Dokumen</h4>
        <table class="table table-hover table-bordered">
          <thead>
            <th class="col-md-11">File</th>
            <th if.bind="!readOnly" class="col-md-1">
              <button click.delegate="onAddDocument()" class="btn btn-success pull-right">+</button>
            </th>
          </thead>
          <tbody>
            <tr if.bind="!data.documentsFileName || data.documentsFileName.length < 1">
              <td colspan="2">
                Tidak ada file
              </td>
            </tr>
            <tr if.bind="data.documentsFileName" repeat.for="doc of data.documentsFileName">
              <td if.bind="readOnly">
                <button class="btn btn-primary justify-content-center"
                  click.delegate="downloadDocument($index)">${doc}</button>
              </td>
              <td if.bind="!readOnly">
                <input if.bind="!documentsPathTemp[$index]" type="file" id="documentInput${$index}"
                  value.bind="documentUpload" change.delegate="documentInputChanged($index)"
                  accept=".pdf, .xls, .xlsx, .doc, .docx">
                <button if.bind="documentsPathTemp[$index]" class="btn btn-primary justify-content-center"
                  click.delegate="downloadDocument($index)">${doc}</button>
                <span class="text-danger" if.bind="error.documentsFile[$index]">${error.documentsFile[$index]}</span>
              </td>
              <td if.bind="!readOnly">
                <button class="btn btn-danger pull-right" click.delegate="onRemoveDocument($index)">-</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </au-input-form>
</template>